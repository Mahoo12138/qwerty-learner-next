# Profile 页面重构文档

## 概述

使用 @mui/joy 组件库重构了 Profile 页面，提供了现代化的用户界面和完整的用户信息管理功能。

## 功能特性

### 1. 用户信息管理
- **查看用户信息**: 显示用户名、邮箱、头像等基本信息
- **编辑个人信息**: 通过 Modal 弹窗修改用户名、邮箱、个人简介
- **修改密码**: 通过 Modal 弹窗修改账户密码

### 2. API Token 管理
- **查看 Token 列表**: 显示所有 API Token 的详细信息
- **创建新 Token**: 通过 Modal 弹窗创建新的 API Token
- **删除 Token**: 删除不再需要的 API Token
- **复制 Token**: 一键复制 Token 到剪贴板
- **Token 状态**: 显示 Token 的有效状态和过期时间

## 技术实现

### 1. UI 组件
- **@mui/joy**: 使用现代化的 Joy UI 组件库
- **响应式设计**: 适配不同屏幕尺寸
- **主题支持**: 支持明暗主题切换
- **加载状态**: 提供友好的加载指示器

### 2. 状态管理
- **React Query**: 使用 TanStack Query 进行服务端状态管理
- **本地状态**: 使用 React useState 管理表单状态
- **缓存策略**: 自动缓存和失效查询结果

### 3. API 集成
- **RESTful API**: 与后端 API 完全集成
- **错误处理**: 完善的错误处理机制
- **乐观更新**: 提供流畅的用户体验

## 组件结构

```
ProfileSettings/
├── 用户信息卡片 (Card)
│   ├── 头像 (Avatar)
│   ├── 用户信息 (Typography)
│   └── 操作按钮 (Button)
├── Token 管理表格 (Table)
│   ├── 表头
│   ├── Token 列表
│   └── 操作列
└── Modal 弹窗
    ├── 编辑信息 Modal
    ├── 修改密码 Modal
    └── 创建 Token Modal
```

## API 接口

### 用户信息相关
- `GET /api/v1/user/profile` - 获取用户信息
- `PUT /api/v1/user/profile` - 更新用户信息
- `POST /api/v1/user/change-password` - 修改密码

### Token 管理相关
- `GET /api/v1/auth/api-tokens` - 获取 API Token 列表
- `POST /api/v1/auth/api-tokens` - 创建新的 API Token
- `DELETE /api/v1/auth/api-tokens/:id` - 删除 API Token

## 使用方式

### 1. 编辑个人信息
1. 点击"编辑"按钮
2. 在弹出的 Modal 中修改信息
3. 点击"保存"按钮提交更改

### 2. 修改密码
1. 点击"修改密码"按钮
2. 输入当前密码和新密码
3. 点击"修改密码"按钮提交

### 3. 管理 API Token
1. **创建 Token**: 点击"创建"按钮，填写 Token 名称和过期时间
2. **复制 Token**: 点击 Token 旁边的复制图标
3. **删除 Token**: 点击删除图标，确认后删除

## 样式特性

### 1. 设计系统
- **一致的颜色**: 使用 Joy UI 的设计令牌
- **统一的间距**: 遵循 8px 网格系统
- **响应式布局**: 适配桌面和移动设备

### 2. 交互反馈
- **加载状态**: 按钮和表格显示加载指示器
- **悬停效果**: 按钮和图标提供悬停反馈
- **禁用状态**: 操作时禁用相关按钮

### 3. 可访问性
- **键盘导航**: 支持完整的键盘操作
- **屏幕阅读器**: 提供适当的 ARIA 标签
- **焦点管理**: 合理的焦点顺序和指示

## 错误处理

### 1. 网络错误
- 自动重试机制
- 用户友好的错误提示
- 降级处理

### 2. 表单验证
- 客户端验证
- 服务端验证反馈
- 实时错误提示

### 3. 权限控制
- 自动检查用户权限
- 未授权时重定向到登录页
- Token 过期自动刷新

## 性能优化

### 1. 数据缓存
- React Query 自动缓存
- 智能的数据失效策略
- 后台数据预取

### 2. 组件优化
- 按需加载组件
- 虚拟滚动（大量数据时）
- 防抖处理

### 3. 网络优化
- 请求去重
- 批量操作
- 压缩传输

## 未来扩展

### 1. 功能增强
- 头像上传功能
- 两步验证设置
- 登录历史查看

### 2. 用户体验
- 拖拽排序 Token
- 批量操作 Token
- 高级搜索和筛选

### 3. 安全性
- Token 权限细分
- 使用统计和分析
- 异常行为检测

## 总结

重构后的 Profile 页面提供了：
- **现代化的 UI**: 使用 @mui/joy 组件库
- **完整的功能**: 用户信息和 Token 管理
- **良好的体验**: 流畅的交互和反馈
- **可靠的架构**: 基于 React Query 的状态管理
- **可维护性**: 清晰的代码结构和文档

这个重构为后续的功能扩展和维护奠定了良好的基础。 